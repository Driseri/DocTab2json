# Парсер таблиц DOCX в JSON

## Обзор
Этот сервис извлекает иерархические данные из таблиц `.docx` на основе следующих правил:
- **Первая колонка** определяет иерархию с помощью числовых идентификаторов (например, `1`, `1.1`, `1.1.3`).
- **Вторая колонка** содержит текстовые значения, которые структурируются в виде дерева JSON.
- **Строки без числовых идентификаторов** в первой колонке вложены в последний найденный номер.
- **Строки, в которых во второй колонке менее 3 символов, игнорируются**.
- **Строки с символом `№` в первой колонке пропускаются**.

## Возможности
- Парсит таблицы из `.docx` документов.
- Формирует иерархическую структуру JSON на основе первой колонки.
- Игнорирует ненужные строки по заданным правилам.
- Выводит JSON в виде **словаря** или **сохраняет в файл**.

## Установка
Этот сервис требует Python 3.7 или новее.

### Установка зависимостей
```bash
pip install python-docx
```

## Использование
### Импорт парсера в Python-проект
```python
from table2json import docx_table_to_json
```

### Разбор `.docx` файла и получение JSON-выходных данных
```python
docx_file = "example.docx"
parsed_data = docx_table_to_json(docx_file)
print(parsed_data)
```

### Сохранение вывода в JSON-файл
```python
docx_table_to_json("example.docx", "output.json")
```

### Использование в командной строке
```bash
python table2json.py example.docx output.json
```
Этот код извлечет данные из `example.docx` и сохранит их в `output.json`.

## Пример
### **Входная таблица DOCX**
| Колонка 1 | Колонка 2 |
|----------|----------|
| 1        | Основная категория |
| 1.1      | Подкатегория 1 |
| 1.2      | Подкатегория 2 |
|          | Элемент A |
|          | Элемент B |
| 2        | Другая категория |
| 2.1      | Подкатегория 3 |
|          | Элемент C |

### **Выходной JSON**
```json
{
    "Основная категория": {
        "Подкатегория 1": {},
        "Подкатегория 2": {
            "Элемент A": {},
            "Элемент B": {}
        }
    },
    "Другая категория": {
        "Подкатегория 3": {
            "Элемент C": {}
        }
    }
}
```

## Обработка ошибок
- Если `.docx` файл не найден, возникает ошибка.
- Если в документе нет таблиц, возвращается пустой словарь.
- Если в первой колонке есть `№`, строка пропускается.
- Если во второй колонке менее 3 символов, строка игнорируется.

## Лицензия
Этот проект лицензирован под MIT License.

## Автор
Разработано Даниилом.

